---
title: "Results"
author: "Stephanie Bland"
date: '2017-10-27'
output: html_document
---

```{r setup, include=FALSE,cache=TRUE}
knitr::opts_chunk$set(cache=TRUE,echo=FALSE)
#---- Hidden ----
library(ggbiplot)
library(tidyverse)
library(MASS)
library(stringr)
DATE="2017Jul19"
Version="0"
location="/GIT/Analysis"#For Running on my Mac
#location=""#For Clusters
run_name=paste0(DATE,"_",Version)
setwd(paste0("~/",location,"/",run_name))
#---- LOAD_DATA ----
backupdata=read.table("Melted.txt",header=F)
colnames(backupdata)=as.matrix(read.table("colnames.txt"))
alldata=backupdata
alldata=alldata[alldata$Prey==0,]
alldata=alldata[alldata$Pred==2,]
alldata=alldata[alldata$Phase_df==2,]

#---- LOAD_DATA ----
# The first step should be setting up better names, so the legends will automatically be named properly. This is to avoid having vague graphs with names like "experiment 1" and experiment 2" because people will definitely forget what that means.
node_names=levels(factor(alldata$Nodes_df))
# In the following line we have some difficulty with node names - after 10 the levels function tries to sort alphabetically but fails miserably.
node_names=cbind(node_names,c("Autotrophs",paste("Life stage",1:4),paste("Fish",1:3),"Fish","Invertebrates",rep("Node",39),"Non Fish","Total Biomass"))
exper_name=c("Leslie & History","Extended Web","Original Web")
```

## First Paragraph: Overall description, general overview

```{r Percent_Stable}
nodes="Fish_tot_df"
persist=alldata %>% group_by(Simnum, Exper, Nodes_df) %>%
	filter(Year_df %in% max(Year_df), Nodes_df %in% nodes) %>%
	spread(key=Exper, value=Biomass) %>%
	summarise(any=sum(`1`,`2`,`3`),all=prod(`1`,`2`,`3`)) %>%
	mutate_at(c("any","all"),as.logical)
# 1.
criteria1=100*sum(persist$any)/length(persist$any)
# 2.
criteria2=100*sum(persist$all)/length(persist$all)
```

Roughly half of our simulations stabilized to periodic or chaotic oscillations within x years. A typical time series of the logged biomass for a stable population is shown in figure x. `r criteria1`

84% of our simulations met the criteria for the first part of the analysis, meaning fish stabilized in at least one of the experiments. Only 18% of our simulations met the second criteria, where at least one fish must stabilize in every experiment. 

Only about half of our simulations stabilized. This is to be expected, as we placed minimal constraints on food webs during the web creation stage. Some of the we created would invariably end up being completely biologically unrealistic. This process of weeding out unstable webs might seem unintuitive at first, but it actually is analogous to what we observe in nature. Just as natural landscapes are eventually populated by stable ecosystems after a long process of species invasions and extinctions. One would not expect to be able to take a random species from a different continent and populate an island and fill a niche that they were not adapted to. The few species that can successfully invade are anomalies. 

Some of the simulations stabilized for invertebrates and autotrophs, while all the fish species went extinct. 

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
